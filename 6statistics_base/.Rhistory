knitr::opts_chunk$set(echo = T)
house_price_gr<-read.csv("data/house_price_gr.csv")
attach(house_price_gr); par(mfrow=c(1,2))
hist(rate,prob=T,main="Distrabution of 住宅价格增长率")
lines(density(rate));qqnorm(rate);qqline(rate); par(mfrow=c(1,1))
mean(rate)
se<-sd(rate)/sqrt(length(rate));se
?highlight
??highlight
View(house_price_gr)
?head
?runif
View(house_price_gr)
creditcard_exp<-read.csv("data/creditcard_exp.csv")
creditcard_exp<-na.omit(creditcard_exp)
creditcard_exp[runif(5,1,nrow(creditcard_exp)),c("avg_exp","gender")]
View(creditcard_exp)
creditcard_exp<-read.csv("data/creditcard_exp.csv")
creditcard_exp<-na.omit(creditcard_exp)
creditcard_exp[runif(5,1,nrow(creditcard_exp)),c("avg_exp","gender")]
creditcard_exp<-read.csv("data/creditcard_exp.csv")
creditcard_exp<-na.omit(creditcard_exp)
creditcard_exp[runif(5,1,nrow(creditcard_exp)),c("avg_exp","gender")]
creditcard_exp<-read.csv("data/creditcard_exp.csv")
creditcard_exp<-na.omit(creditcard_exp)
creditcard_exp$gender<-as.factor(creditcard_exp$gender)
creditcard_exp[runif(5,1,nrow(creditcard_exp)),c("avg_exp","gender")]
detach(creditcard_exp)
detach(creditcard_exp)
attach(creditcard_exp)
tapply(avg_exp, gender, summary)
barplot(avg_exp~gender)
attach(creditcard_exp)
tapply(avg_exp, gender, summary)
boxplot(avg_exp~gender)
attach(creditcard_exp)
as.data.frame(tapply(avg_exp, gender, summary))
boxplot(avg_exp~gender)
?tapply
attach(creditcard_exp)
tapply(avg_exp, gender, summary)
boxplot(avg_exp~gender)
detach(creditcard_exp)
detach(creditcard_exp)
detach(creditcard_exp)
detach(creditcard_exp)
detach(creditcard_exp)
detach(creditcard_exp)
detach(creditcard_exp)
detach(creditcard_exp)
install.packages("highlight")
library(highlight)
?highlight
View(creditcard_exp)
creditcard_exp<-read.csv("data/creditcard_exp.csv")
creditcard_exp<-na.omit(creditcard_exp)
creditcard_exp$gender<-as.factor(creditcard_exp$gender)
creditcard_exp$edu_class<-as.factor(creditcard_exp$edu_class)
creditcard_exp[runif(3,1,nrow(creditcard_exp)),c("avg_exp","gender")]
attach(creditcard_exp)
tapply(avg_exp, gender, summary);boxplot(avg_exp~gender)
var.test(avg_exp~gender)
boxplot(avg_exp~edu_class)
plot(as.numeric(edu_class),avg_exp,col=gender)
plot(edu_class,avg_exp,col=gender)
plot(as.numeric(edu_class),avg_exp,col=gender)
?tapply
tapply(avg_exp,c(edu_class,gender),mean)
tapply(avg_exp,edu_class,gender,mean)
View(creditcard_exp)
tapply(avg_exp,edu_class*gender,mean)
tapply(avg_exp,edu_class,mean)
tapply(avg_exp,gender,mean)
tapply(avg_exp,edu_class,gender,mean)
tapply(avg_exp,list(edu_class,gender),mean)
(625+817)/2
table(edu_class,gender)
plot(as.numeric(edu_class),avg_exp,col=gender)
?segments
mv<-tapply(avg_exp,list(edu_class,gender),mean) ##各分组下的均值
View(mv)
plot(as.numeric(edu_class),avg_exp,col=gender)
segments(1,mv[1,1],2,mv[2,1])
plot(as.numeric(edu_class),avg_exp,col=gender)
legend
?mode
plot(as.numeric(edu_class),avg_exp,col=gender)
legend("topright",pch=1,col=c("red","black"),legend=c("男","女"))
plot(as.numeric(edu_class),avg_exp,col=gender)
legend("topleft",pch=1,col=c("red","black"),legend=c("男","女"))
mv<-data.frame(x=0:3,tapply(avg_exp,list(edu_class,gender),mean))
mv
table(edu_class)
plot(as.numeric(edu_class)-1,avg_exp,col=gender)
lines(mv$x,mv$X0,type=o)
lines(mv$x,mv$X0,type='o')
lines(mv$x,mv$X1,type='o',col="red")
t<-plot(as.numeric(edu_class)-1,avg_exp,col=gender)
plot(as.numeric(edu_class)-1,avg_exp,col=gender)
legend("topleft",pch=1,col=c("red","black"),legend=c("男","女"))
mv<-data.frame(gender=0:3,tapply(avg_exp,list(edu_class,gender),mean))
mv
names(mv)<-c("edu_class","female","male")
("educlass","female","male")
names(mv)<-c("educlass","female","male")
mv
plot(as.numeric(edu_class)-1,avg_exp,col=gender)
legend("topleft",pch=1,col=c("red","black"),legend=c("男","女"))
lines(mv$gender,mv$X0,type='l',)
lines(mv$gender,mv$X1,type='l')
plot(as.numeric(edu_class)-1,avg_exp,col=gender)
legend("topleft",pch=1,col=c("red","black"),legend=c("男","女"))
lines(mv$gender,mv$X0,type='l',)
lines(mv$gender,mv$X1,type='l')
plot(as.numeric(edu_class)-1,avg_exp,col=gender)
legend("topleft",pch=1,col=c("red","black"),legend=c("男","女"))
lines(mv$gender,mv$female,type='l',)
lines(mv$gender,mv$male,type='l',col="red")
plot(as.numeric(edu_class)-1,avg_exp,col=gender)
legend("topleft",pch=1,col=c("red","black"),legend=c("男","女"))
lines(mv$educlass,mv$female,type='l')
lines(mv$educlass,mv$male,type='l',col="red")
?factor
?class
?mode
class(1)
class("c")
class(T)
mode(T)
mode(se)
mode("a")
mode(as.factor("a"))
class(as.factor("a"))
View(creditcard_exp)
ncol(mtcars)
accepts<-read.csv("accepts.csv")
accepts<-read.csv("data/accepts.csv")
accepts<-read.csv("data/accepts.csv")
attach(accepts)
table(bankruptcy_ind,bad_ind)
chisq.test(x=bankruptcy_ind,y=bad_ind)
detach(accepts)
View(accepts)
accepts<-read.csv("data\accepts.csv",stringsAsFactors=F)
xtabs( ~bankruptcy_ind+bad_ind,data=accepts)
library(prettyR)
xtab( ~bankruptcy_ind+bad_ind,data=accepts)
xtab( ~bankruptcy_ind+bad_ind,data=accepts,chisq = T)
chisq.test(x=accepts$bankruptcy_ind,y=accepts$bad_ind)
t1<-xtab( ~bankruptcy_ind+bad_ind,data=accepts,chisq = T)
t1$counts
t1$row.margin
t1$col.margin
t1$varnames
t1<-c(rnorm(nosim)
)
nosim <- 10000; n <- 10
)
t1<-c(rnorm(nosim))
t2<-apply(matrix(rnorm(nosim*n),nosim),1,mean)
what=factor(rep(c("Obs", "Mean"),c(nosim,nosim)))
?rep
rep(c("a","v"),c(2,1))
t1<-factor(rep(1:4,rep(nosim,4)))
?facet_grid
??facet_grid
nosim <- 10000;
dat <- data.frame(
x = c(apply(matrix(rnorm(nosim * 10), nosim), 1, var),
apply(matrix(rnorm(nosim * 20), nosim), 1, var),
apply(matrix(rnorm(nosim * 30), nosim), 1, var)),
n = factor(rep(c("10", "20", "30"), c(nosim, nosim, nosim)))
)
ggplot(dat, aes(x = x, fill = n)) + geom_density(size = 2, alpha = .2) + geom_vline(xintercept = 1, size = 2)
library(ggplot2)
nosim <- 10000;
dat <- data.frame(
x = c(apply(matrix(rnorm(nosim * 10), nosim), 1, var),
apply(matrix(rnorm(nosim * 20), nosim), 1, var),
apply(matrix(rnorm(nosim * 30), nosim), 1, var)),
n = factor(rep(c("10", "20", "30"), c(nosim, nosim, nosim)))
)
ggplot(dat, aes(x = x, fill = n)) + geom_density(size = 2, alpha = .2) + geom_vline(xintercept = 1, size = 2)
nosim<-1000;n<-10
sd(apply(matrix(rnorm(nosim*n),nosim),1,mean))
1/sqrt(n)
nosim<-1000;n<-10
sd(apply(matrix(rpois(nosim*n,4),nosim),1,mean))
1/sqrt(n)
nosim<-1000;n<-10
sd(apply(matrix(rpois(nosim*n,4),nosim),1,mean))
2/sqrt(n)
dat<-data.frame(x=c(sample(1:6,nosim,replace=T),
apply(matrix(sample(1:6,nosim*2,replace=T),nosim),1,mean),
apply(matrix(sample(1:6,nosim*3,replace=T),nosim),1,mean),
apply(matrix(sample(1:6,nosim*10,replace=T),nosim),1,mean)),
size=factor(rep(c(1,2,3,10),rep(nosim,4))))
g<-ggplot(dat,aes(x=x,fill=size))+geom_histogram(alpha =.20,binwidth=.25,colour="black")
g+facet_grid(.~size)
sqrt(.1*.9)
rbinom(10, prob = 0.1, size = 10)
rbinom(1000, prob = 0.1, size = 10)
rbinom(1000, prob = 0.1, size = 100)
qnorm(0.995,0,1)
qnorm(0.9995,0,1)
pnorm(3,0,1)
(1-pnorm(3,0,1))*2
(1-pnorm(2.33,0,1))*2
(1-pnorm(2.57,0,1))*2
?qt
?rnorm
qnorm
qnorm(97.5,0,1)
qnorm(0.975,0,1)
qnorm(0.975)
house_price_gr<-read.csv("data/house_price_gr.csv")
house_price_gr[runif(2,1,nrow(house_price_gr)),]
attach(house_price_gr); par(mfrow=c(1,2),mar=c(4,4,1,4))
hist(rate,prob=T,main="Distrabution of 住宅价格增长率")
lines(density(rate));qqnorm(rate);qqline(rate); par(mfrow=c(1,1))
mean(rate)
se<-sd(rate)/sqrt(length(rate));se
LB<-mean(rate)-1.96*se; UB<-mean(rate)+1.96*se; c(LB,UB)
confint<-function(x,alpha=0.05)
{ n<-length(x);xb<-mean(x)
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
data.frame(mean=xb,LB=xb-tmp,UB=xb+tmp)}
confint(rate,0.01)
(sd(rate)/sqrt(n))*qnorm(1-alpha/2)
(sd(rate)/sqrt(n))*qnorm(1-0.05/2)
se*qnorm(1-0.05/2)
se
sd(rate)/sqrt(n)
length(rate)
se<-sd(rate)/sqrt(length(rate));se
sd(rate)/sqrt(length(rate))
n
confint<-function(x,alpha=0.05)
{ n<-length(x);xb<-mean(x)
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
data.frame(mean=xb,LB=xb-tmp,UB=xb+tmp)}
confint(rate,0.01)
n<-lengthrate)
n<-length(rate)
n
confint<-function(x,alpha=0.05)
{ n<-length(x);xb<-mean(x)
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
data.frame(mean=xb,LB=xb-tmp,UB=xb+tmp)}
confint(rate,0.01)
View(house_price_gr)
nrow(rate)
confint<-function(x,alpha=0.05)
{ n<-length(x);xb<-mean(x)
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
data.frame(mean=xb,LB=xb-tmp,UB=xb+tmp)}
confint(house_price_gr$rate,0.01)
n
mean(rate)
se<-sd(rate)/sqrt(length(rate));se
LB<-mean(rate)-1.96*se; UB<-mean(rate)+1.96*se; c(LB,UB)
confint<-function(x,alpha=0.05)
{ n<-length(x);xb<-mean(x)
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
data.frame(mean=xb,LB=xb-tmp,UB=xb+tmp)}
confint(rate,0.01);detach(house_price_gr)
n
rm(list=ls())
house_price_gr<-read.csv("data/house_price_gr.csv")
house_price_gr[runif(2,1,nrow(house_price_gr)),]
attach(house_price_gr); par(mfrow=c(1,2),mar=c(4,4,1,4))
hist(rate,prob=T,main="Distrabution of 住宅价格增长率")
lines(density(rate));qqnorm(rate);qqline(rate); par(mfrow=c(1,1))
mean(rate)
se<-sd(rate)/sqrt(length(rate));se
LB<-mean(rate)-1.96*se; UB<-mean(rate)+1.96*se; c(LB,UB)
confint<-function(x,alpha=0.05)
{ n<-length(x);xb<-mean(x)
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
data.frame(mean=xb,LB=xb-tmp,UB=xb+tmp)}
confint(rate,0.01);detach(house_price_gr)
confint<-function(x,alpha=0.05)
{ n<-length(x);xb<-mean(x)
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
data.frame(mean=xb,LB=xb-tmp,UB=xb+tmp)}
confint(rate,0.01);detach(house_price_gr)
confint<-function(x,alpha=0.05)
{ n<-length(x);xb<-mean(x)
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
data.frame(mean=xb,LB=xb-tmp,UB=xb+tmp)}
confint(rate,0.01)
house_price_gr<-read.csv("data/house_price_gr.csv")
house_price_gr[runif(2,1,nrow(house_price_gr)),]
attach(house_price_gr); par(mfrow=c(1,2),mar=c(4,4,1,4))
hist(rate,prob=T,main="Distrabution of 住宅价格增长率")
lines(density(rate));qqnorm(rate);qqline(rate); par(mfrow=c(1,1))
mean(rate)
se<-sd(rate)/sqrt(length(rate));se
LB<-mean(rate)-1.96*se; UB<-mean(rate)+1.96*se; c(LB,UB)
confint<-function(x,alpha=0.05)
{ n<-length(x);xb<-mean(x)
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
data.frame(mean=xb,LB=xb-tmp,UB=xb+tmp)}
confint(rate,0.01)
x<-rate
n<-length(x);xb<-mean(x)
alpha=0.05
tmp<-(sd(x)/sqrt(n))*qnorm(1-alpha/2)
confint(rate,0.05)
?manipulate
??manipulate
library(manipulate)
install.packages("manipulate")
install.packages("C:/Users/jiang/Downloads/temp/manipulate_1.0.1.tar.gz", repos = NULL, type = "source")
install.packages("manipulate")
library(manipulate);k<-1000
xvals<-seq(-5,5,length=k)
myplot<-function(df){
d<-data.frame(y=c(dnorm(xvals),dt(xvals,df)),x=xvals,
dist=factor(rep(c("Normal","T"),c(k,k))))
g<-ggplot(d,aes(x=x,y=y))+geom_line(size=2,aes(colour=dist))
g}
manipulate(myplot(mu),mu=slider(1,20,step=1))
library(manipulate);k<-1000
xvals<-seq(-5,5,length=k)
myplot<-function(df){
d<-data.frame(y=c(dnorm(xvals),dt(xvals,df)),x=xvals,
dist=factor(rep(c("Normal","T"),c(k,k))))
g<-ggplot(d,aes(x=x,y=y))+geom_line(size=2,aes(colour=dist))
g}
manipulate(myplot(mu),mu=slider(1,20,step=1))
library(manipulate);k<-1000
xvals<-seq(-5,5,length=k)
myplot<-function(df){
d<-data.frame(y=c(dnorm(xvals),dt(xvals,df)),x=xvals,
dist=factor(rep(c("Normal","T"),c(k,k))))
g<-ggplot(d,aes(x=x,y=y))+geom_line(size=2,aes(colour=dist))
g}
manipulate(myplot(mu),mu=slider(1,20,step=1))
library(manipulate);k<-1000
xvals<-seq(-3,3,length=k)
myplot<-function(df){
d<-data.frame(y=c(dnorm(xvals),dt(xvals,df)),x=xvals,
dist=factor(rep(c("Normal","T"),c(k,k))))
g<-ggplot(d,aes(x=x,y=y))+geom_line(size=2,aes(colour=dist))
g}
manipulate(myplot(mu),mu=slider(1,20,step=1))
t.test(rate,mu=0.1)
creditcard_exp<-read.csv("data/creditcard_exp.csv")
creditcard_exp<-na.omit(creditcard_exp)
creditcard_exp$gender<-as.factor(creditcard_exp$gender)
creditcard_exp$edu_class<-as.factor(creditcard_exp$edu_class)
creditcard_exp[runif(3,1,nrow(creditcard_exp)),c("avg_exp","gender")]
library(manipulate);k<-1000
xvals<-seq(-5,5,length=k)
myplot<-function(df){
d<-data.frame(y=c(dnorm(xvals),dt(xvals,df)),x=xvals,
dist=factor(rep(c("Normal","T"),c(k,k))))
g<-ggplot(d,aes(x=x,y=y))+geom_line(size=2,aes(colour=dist))
g}
manipulate(myplot(mu),mu=slider(1,30,step=1))
g1 <- sleep$extra[1 : 10]; g2 <- sleep$extra[11 : 20]
difference <- g2 - g1
mn <- mean(difference); s <- sd(difference); n <- 10
mn + c(-1, 1) * qt(.975, n-1) * s / sqrt(n)
t.test(difference)
t.test(g2, g1, paired = TRUE)
t.test(extra ~ I(relevel(group, 2)), paired = TRUE, data = sleep)
t1<-t.test(difference)
t1$conf.int
t.test(difference)$conf
t.test(difference)$conf[1]
t.test(difference)$conf[2]
t.test(difference)$conf[1:2]
t.test(difference)$conf[3]
t.test(difference)$conf[[1]]
t.test(difference)$conf[1,2]
t.test(difference)$conf[1:2]
data(sleep)
sleep
t.test(extra~group,paired=T,data=sleep)
t.test(extra~I(relevel(group,2)),paired=T,data=sleep)
t.test(extra~I(relevel(group,2)),paired=T,data=sleep)$conf[1:2]
t.test(extra~I(relevel(group,2)),paired=F,data=sleep)$conf[1:2]
library(ggplot2)
g <- ggplot(sleep, aes(x = group, y = extra, group = factor(ID)))
g <- g + geom_line(size = 1, aes(colour = ID)) + geom_point(size =10, pch = 21, fill = "salmon", alpha = .5)
g
?rbiom
?rbinom
rbinom(10,20,0.5)
rbinom(10,20,0.5)/20
